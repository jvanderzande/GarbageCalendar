# How does it work?

The main script "<b>script_time_garbagecalendar.lua</b>" needs to be stored in the "domoticz/scripts/lua" directory which will cause it to trigger each minute. The main script will load your personal configuration from "<b>garbagecalendar/garbagecalendarconfig.lua</b>", where you have defined all required information as explained in the [Setup Wiki page](Setup). It will read the information from the variable "garbagetype_cfg" table to check for the specified update/notification times defined, and when one of these times is equal to the current time, the following things will happen:<br>
1. When the garbagetype field contains "reloaddata", an background batchjob will be submitted to update the data. The retrieved data will be stored in file **"garbagecalendar_modulesname.data"** and the retrieval process information in **"garbage_web_modulename.log"**. They will both be located in the directory you specified for **"datafilepath"**. This process will be ran in the foreground immediately in case the **"garbagecalendar_modulesname.data"** doesn't exist yet and one of the check times is valid, to ensure the data is there to work with.
2. The next number of events, as defined with **ShowNextEvents**, will be merged into a text field, with the format as defined with **textformat**.<br>
3. Update the defined Domoticz Text Dummy Device with this formatted text.
4. When it contains a valid Garbage type and the **hour** & **min** are equal to the current time, a notification will be send as specified in the **garbagecalendarconfig.lua** file. 
